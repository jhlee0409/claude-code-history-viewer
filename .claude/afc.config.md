# Selfish Configuration for claude-code-history-viewer

> 프로젝트별 코드 리뷰, 구현, 디버깅 설정
> Auto-generated by `/selfish:init` on 2026-02-23

## CI Commands

```yaml
ci: "pnpm tsc --build . && pnpm lint && pnpm vitest run --reporter=verbose"
typecheck: "pnpm tsc --build ."
lint: "pnpm lint"
lint_fix: "pnpm lint --fix"
gate: "pnpm tsc --build . && pnpm lint"
test: "pnpm vitest run --reporter=verbose"
test_backend: "cd src-tauri && cargo test -- --test-threads=1"
clippy: "cd src-tauri && cargo clippy --all-targets --all-features -- -D warnings"
fmt_check: "cd src-tauri && cargo fmt --all -- --check"
i18n_validate: "pnpm run i18n:validate"
```

## Architecture

```yaml
style: "Layered + Module-based"
layers:
  - "components (UI)"
  - "hooks (Logic)"
  - "store (State)"
  - "services (API Integration)"
  - "types (Contracts)"
  - "utils (Shared)"
import_rule: "upper → lower only; utils/types are shared across all layers"
segments:
  - "Frontend: React + Vite (src/)"
  - "Backend: Rust + Tauri (src-tauri/src/)"
path_alias: "@/* → ./src/*"
```

## Framework

```yaml
name: "Tauri 2 + Vite 7 + React 19"
runtime: "Tauri IPC (Rust ↔ React)"
client_directive: ""
client_directive_rule: ""
server_client_boundary: true  # Rust backend ↔ React frontend via Tauri IPC
```

## Code Style

```yaml
language: "TypeScript + Rust"
strict_mode: true
type_keyword: "type"
import_type: true
component_style: "PascalCase"
props_position: "above component"
handler_naming: "handle[Event]"
boolean_naming: "is/has/can[State]"
constant_naming: "UPPER_SNAKE_CASE"
any_policy: "forbidden"  # ESLint no-explicit-any enforced
```

### TypeScript / React
- **Strict Mode**: `strict: true`, `noUnusedLocals`, `noUnusedParameters`, `noUncheckedIndexedAccess`
- Components: Functional components with React hooks
- State: Zustand slices pattern
- Memoization: `React.memo()` for virtual list items
- Imports: Absolute `@/` alias
- i18n: All UI text wrapped in `t()` from `react-i18next`
- No `any`: Use `as unknown as TargetType` pattern

### Rust
- Edition: 2021
- Clippy: `-D warnings` (all warnings are errors)
- Formatting: `cargo fmt` enforced
- Naming: modules/functions `snake_case`, types `PascalCase`, constants `UPPER_SNAKE_CASE`
- Path validation: Symlink checks, traversal prevention
- Atomic writes: Temp file + rename pattern
- Tests: `--test-threads=1` (env::set_var race condition)

## State Management

```yaml
global_state: "Zustand (slices pattern)"
server_state: "Tauri IPC commands"
local_state: "useState, useReducer"
store_location: "src/store/useAppStore.ts + src/store/slices/"
query_location: "src/hooks/ (Tauri command wrappers)"
```

## Styling

```yaml
framework: "Tailwind CSS v4"
utility: "tailwind-merge + clsx"
components: "Radix UI primitives + custom components"
```

## Testing

```yaml
framework: "Vitest"
runner: "vitest"
watch: "vitest --watch"
coverage: "vitest --coverage"
```

## Key Patterns & Checklist

### 보안 (Security)
- 사용자 입력 ID를 파일 경로에 사용할 때 → `^[A-Za-z0-9_-]+$` 검증 필수
- 파일 쓰기 → temp 파일 + rename 패턴 (원자적 쓰기)
- Rust에서 디렉토리 순회 시 symlink 차단

### 에러 처리 (Error Handling)
- 모든 `async/await` → try/catch + 사용자에게 보이는 피드백 (toast/alert)
- 다단계 저장 → 모든 파싱/검증을 먼저 완료한 후 적용
- 필수 매개변수(`projectPath` 등) → 함수 시작부에 가드 배치

### i18n
- 새 키 추가 → 5개 locale 파일(en, ko, ja, zh-CN, zh-TW) 모두 동시 업데이트
- JSON 중복 키 절대 금지 — `pnpm run i18n:validate`로 검증
- TSX 내 사용자에게 보이는 문자열 → 반드시 `t()` 래핑

### 접근성 (a11y)
- 아이콘 전용 버튼 → `aria-label` 필수
- Dialog → `DialogTitle` 또는 `aria-label` 필수
- `Label`-`Input` 쌍 → `htmlFor`/`id` 연결, ID는 `React.useId()`
- `TooltipTrigger` → 포커스 가능한 요소(`<button>`)로 감싸기

### React 상태 관리
- `setState` 직후 해당 상태를 읽지 말 것 → 값을 인자로 직접 전달하거나 `useEffect` 사용
- 커스텀 훅 내부에서 다른 커스텀 훅 호출 → 인스턴스 분리 문제 주의

### 크로스 플랫폼
- 경로 split → `split(/[\\/]/)` (Windows `\` 대응)
- Rust `fs::rename` → Windows에서 대상 존재 시 실패, `remove_file` 후 rename
- 홈 디렉토리 감지 → `C:\Users\` 패턴 포함

### 기타
- 유틸리티 함수 작성 전 → 기존 utils에 동일 기능 있는지 확인
- null 체크 → `!= null` (loose equality)로 null+undefined 동시 처리
- `localStorage` 접근 → 항상 try/catch
